"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7079],{3999:(e,t,r)=>{r.d(t,{A:()=>o});var a=r(7876),s=r(4232),l=r(9099),n=r(5261);function o(e){return function(t){let r=(0,l.useRouter)(),[o,d]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{(async()=>{try{if(!localStorage.getItem("isAdmin")){r.push("/admin/login");return}if(!await (0,n.uu)()){localStorage.removeItem("isAdmin"),r.push("/admin/login");return}d(!1)}catch(e){console.error("Auth check error:",e),r.push("/admin/login")}})()},[r]),o)?(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-xl",children:"Loading..."})}):(0,a.jsx)(e,{...t})}}},5261:(e,t,r)=>{r.d(t,{jL:()=>n,uu:()=>l,wR:()=>s}),r(3426),r(5611);var a=r(5364);async function s(){try{return(await fetch("/_api/web/currentuser",{method:"GET",headers:{Accept:"application/json;odata=verbose"},credentials:"include"})).ok}catch(e){return console.error("Authentication check failed:",e),!1}}async function l(){try{let{clientDataService:e}=await Promise.resolve().then(r.bind(r,5611));return await e.isCurrentUserAdmin()}catch(e){return console.error("Admin check failed:",e),!1}}function n(){let e=encodeURIComponent(window.location.href);window.location.href="/_layouts/15/authenticate.aspx?Source=".concat(e)}r(8220).Buffer,a.env.JWT_SECRET},8841:(e,t,r)=>{r.d(t,{A:()=>d});var a=r(7876),s=r(4232),l=r(9099),n=r(5611),o=r(9848);let d=e=>{let{projectId:t,onCancel:r}=e,d=(0,l.useRouter)(),[c,i]=(0,s.useState)(!1),[u,m]=(0,s.useState)([]),[g,b]=(0,s.useState)(!!t),[h,x]=(0,s.useState)({title:"",category:"",startQuarter:"Q1 2023",endQuarter:"Q4 2023",description:"",status:"planned",projektleitung:"",bisher:"",zukunft:"",fortschritt:0,geplante_umsetzung:"",budget:"",teamMembers:[{name:"",role:""}],fields:{process:[""],technology:[""],services:[""],data:[""]}}),p=(0,s.useCallback)(async e=>{try{b(!0);let t=await n.clientDataService.getProjectById(e);if(!t){o.oR.error("Project not found"),d.push("/admin");return}let r=await n.clientDataService.getTeamMembersByProjectId(e),a=await n.clientDataService.getFieldsByProjectId(e),s=a.filter(e=>"PROCESS"===e.type).map(e=>e.value),l=a.filter(e=>"TECHNOLOGY"===e.type).map(e=>e.value),c=a.filter(e=>"SERVICE"===e.type).map(e=>e.value),i=a.filter(e=>"DATA"===e.type).map(e=>e.value);0===s.length&&s.push(""),0===l.length&&l.push(""),0===c.length&&c.push(""),0===i.length&&i.push("");let u=r.map(e=>({name:e.name,role:e.role}));0===u.length&&u.push({name:"",role:""}),x({...t,teamMembers:u,fields:{process:s,technology:l,services:c,data:i}})}catch(e){console.error("Error fetching project data:",e),o.oR.error("Failed to load project data")}finally{b(!1)}},[d]),y=(0,s.useCallback)(async()=>{try{let e=await n.clientDataService.getAllCategories();m(e)}catch(e){console.error("Error fetching categories:",e),o.oR.error("Failed to load categories")}},[]);(0,s.useEffect)(()=>{y(),t&&p(t)},[t,y,p]);let j=e=>{let{name:t,value:r}=e.target;x(e=>({...e,[t]:r}))},v=(e,t,r)=>{x(a=>{let s=[...a.teamMembers];return s[e]={...s[e],[t]:r},{...a,teamMembers:s}})},f=e=>{x(t=>{let r=[...t.teamMembers];return r.splice(e,1),{...t,teamMembers:r.length?r:[{name:"",role:""}]}})},N=(e,t,r)=>{x(a=>{let s={...a.fields};return s[e][t]=r,{...a,fields:s}})},w=e=>{x(t=>{let r={...t.fields};return r[e]=[...r[e],""],{...t,fields:r}})},k=(e,t)=>{x(r=>{let a={...r.fields};return a[e].splice(t,1),0===a[e].length&&(a[e]=[""]),{...r,fields:a}})},C=async e=>{e.preventDefault(),i(!0);try{let e=h.teamMembers.filter(e=>e.name&&e.role),r={process:h.fields.process.filter(e=>e),technology:h.fields.technology.filter(e=>e),services:h.fields.services.filter(e=>e),data:h.fields.data.filter(e=>e)},a={title:h.title||"",category:h.category||"",startQuarter:h.startQuarter||"",endQuarter:h.endQuarter||"",description:h.description||"",status:h.status||"planned",projektleitung:h.projektleitung||"",bisher:h.bisher||"",zukunft:h.zukunft||"",fortschritt:h.fortschritt||0,geplante_umsetzung:h.geplante_umsetzung||"",budget:h.budget||"",teamMembers:e,fields:r};t?(await n.clientDataService.updateProject(t,a),o.oR.success("Project updated successfully")):(await n.clientDataService.createProject(a),o.oR.success("Project created successfully")),d.push("/admin")}catch(e){console.error("Error saving project:",e),o.oR.error(t?"Failed to update project":"Failed to create project")}finally{i(!1)}};return g?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("p",{className:"text-lg",children:"Loading project data..."})}):(0,a.jsxs)("form",{onSubmit:C,className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Project Title"}),(0,a.jsx)("input",{type:"text",name:"title",value:h.title,onChange:j,className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Category"}),(0,a.jsxs)("select",{name:"category",value:h.category,onChange:j,className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select a category"}),u.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Start Quarter"}),(0,a.jsx)("input",{type:"text",name:"startQuarter",value:h.startQuarter,onChange:j,className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",placeholder:"e.g., Q1 2023",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"End Quarter"}),(0,a.jsx)("input",{type:"text",name:"endQuarter",value:h.endQuarter,onChange:j,className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",placeholder:"e.g., Q4 2023",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Status"}),(0,a.jsxs)("select",{name:"status",value:h.status,onChange:j,className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",required:!0,children:[(0,a.jsx)("option",{value:"planned",children:"Planned"}),(0,a.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,a.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Project Lead"}),(0,a.jsx)("input",{type:"text",name:"projektleitung",value:h.projektleitung,onChange:j,className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Description"}),(0,a.jsx)("textarea",{name:"description",value:h.description,onChange:j,className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",rows:3})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Previous Work"}),(0,a.jsx)("textarea",{name:"bisher",value:h.bisher,onChange:j,className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",rows:3})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Future Plans"}),(0,a.jsx)("textarea",{name:"zukunft",value:h.zukunft,onChange:j,className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",rows:3})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Progress (%)"}),(0,a.jsx)("input",{type:"number",name:"fortschritt",value:h.fortschritt,onChange:j,className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white",min:"0",max:"100"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Planned Implementation"}),(0,a.jsx)("input",{type:"text",name:"geplante_umsetzung",value:h.geplante_umsetzung,onChange:j,className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Budget"}),(0,a.jsx)("input",{type:"text",name:"budget",value:h.budget,onChange:j,className:"w-full p-2 bg-gray-700 border border-gray-600 rounded text-white"})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Team Members"}),h.teamMembers.map((e,t)=>(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 p-3 bg-gray-700 rounded",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Name"}),(0,a.jsx)("input",{type:"text",value:e.name,onChange:e=>v(t,"name",e.target.value),className:"w-full p-2 bg-gray-600 border border-gray-500 rounded text-white"})]}),(0,a.jsxs)("div",{className:"flex items-end",children:[(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Role"}),(0,a.jsx)("input",{type:"text",value:e.role,onChange:e=>v(t,"role",e.target.value),className:"w-full p-2 bg-gray-600 border border-gray-500 rounded text-white"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>f(t),className:"ml-2 mb-1 p-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Remove"})]})]},t)),(0,a.jsx)("button",{type:"button",onClick:()=>{x(e=>({...e,teamMembers:[...e.teamMembers,{name:"",role:""}]}))},className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Add Team Member"})]}),(0,a.jsxs)("div",{className:"bg-gray-800 p-4 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Custom Fields"}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h4",{className:"text-lg font-medium mb-3",children:"Process"}),h.fields.process.map((e,t)=>(0,a.jsxs)("div",{className:"flex mb-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>N("process",t,e.target.value),className:"flex-grow p-2 bg-gray-700 border border-gray-600 rounded text-white",placeholder:"Process name"}),(0,a.jsx)("button",{type:"button",onClick:()=>k("process",t),className:"ml-2 p-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Remove"})]},t)),(0,a.jsx)("button",{type:"button",onClick:()=>w("process"),className:"mt-1 px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"Add Process"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h4",{className:"text-lg font-medium mb-3",children:"Technology"}),h.fields.technology.map((e,t)=>(0,a.jsxs)("div",{className:"flex mb-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>N("technology",t,e.target.value),className:"flex-grow p-2 bg-gray-700 border border-gray-600 rounded text-white",placeholder:"Technology name"}),(0,a.jsx)("button",{type:"button",onClick:()=>k("technology",t),className:"ml-2 p-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Remove"})]},t)),(0,a.jsx)("button",{type:"button",onClick:()=>w("technology"),className:"mt-1 px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"Add Technology"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h4",{className:"text-lg font-medium mb-3",children:"Services"}),h.fields.services.map((e,t)=>(0,a.jsxs)("div",{className:"flex mb-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>N("services",t,e.target.value),className:"flex-grow p-2 bg-gray-700 border border-gray-600 rounded text-white",placeholder:"Service name"}),(0,a.jsx)("button",{type:"button",onClick:()=>k("services",t),className:"ml-2 p-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Remove"})]},t)),(0,a.jsx)("button",{type:"button",onClick:()=>w("services"),className:"mt-1 px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"Add Service"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-medium mb-3",children:"Data"}),h.fields.data.map((e,t)=>(0,a.jsxs)("div",{className:"flex mb-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>N("data",t,e.target.value),className:"flex-grow p-2 bg-gray-700 border border-gray-600 rounded text-white",placeholder:"Data name"}),(0,a.jsx)("button",{type:"button",onClick:()=>k("data",t),className:"ml-2 p-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Remove"})]},t)),(0,a.jsx)("button",{type:"button",onClick:()=>w("data"),className:"mt-1 px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"Add Data"})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{type:"submit",disabled:c,className:"px-6 py-2 rounded text-white ".concat(c?"bg-blue-700":"bg-blue-600 hover:bg-blue-700"),children:c?"Saving...":t?"Update Project":"Create Project"}),(0,a.jsx)("button",{type:"button",onClick:r,className:"px-6 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Cancel"})]})]})}}}]);